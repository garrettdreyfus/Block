<!DOCTYPE HTML>

html
  .head
    include crush/includes/head
    include crush/includes/nav_3
    style
      #sortable { list-style-type: none;  margin: 0; padding: 0; width: 200px;}
      #sortable li { padding-left: 10px; padding-top: 10px;  margin: 0 3px 3px 3px; font-size: 1.4em; height: 40px; background-color: #B6C0D2; -webkit-box-shadow:  0px 0px 10px 1px rgba(0, 0, 0, .1);   }
    script
      $(document).ready(function() {
        var changeCount = 0;
        $("#success-alert").hide();

        $( "#sortable" ).sortable();
        $( "#sortable" ).disableSelection();
        $("#close-button").on("click", function(e) {
          $("#success-alert").hide();
        });
        {% for o in classes %}
          var {{o.Class_Name|cut:' '|cut:'.'}} = '<h10> #{o.Class_Description|escapejs|cut:'.'} </h10>' ;
          $("##{o.Class_Name|slugify}").popover({trigger: "hover", content: {{o.Class_Name|cut:' '|cut:'.'}}, html:true , title: '{{o.Teacher|escapejs}}' });
        {% endfor %}
        function idsToArray(ids) {
          var values = [];
          for(var i=0; i<ids.length; i++) {
            values.push($('#'+ids[i]).attr("name"));
          }
          return values;
        }
        $("#submit").on("click", function(e){
          if(changeCount>1) 
            $("#alert-body").html("You preferences have been changed!");
          changeCount++;
          $(".alert").alert();
          $("#success-alert").show();
          var postUrl = "pref_reg/";
          var prefs = $("#sortable").sortable("toArray");
          prefs = idsToArray(prefs);
          var dataString = prefs.join(',');
          var data = {"data": dataString,csrfmiddlewaretoken:'{{csrf_token}}' };
          $.post(postUrl, data);
        });
      });
    body(style="background-color: #BAEFFF; padding-top: 15px; ")
      | <div id="success-alert" class="alert alert-block alert-success fade in">
      |	  <button type="button" class="close" id="close-button">x</button>
      |	  <h4 class="alert-heading">Success!</h4>
      |	  <p id="alert-body">
      |	  Your Preferences have been noted!
      |	  </p>
      | </div>
      br
      h1(style="padding-left: 5px;") Please order your preferences.
      ul(id="sortable", name="sortable",style="margin-top: 50px; margin-left: 100px")
        if classes
          each classes in classes
            li(class="ui-stat-default",name= "#{classes.Class_Name}", id="{{classes.Class_Name|slugify}}", rel= "popover",value="#{classes.Class_Name}")#{classes.Class_Name}
      input.btn-Gret(type="submit", value = "Submit", id= "submit", name = "submit", style = "margin-left:105px; margin-bottom:60px; margin-top:20px;")

